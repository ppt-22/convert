id,rulepack,rule_src,type_id,name,description,tags,kc,classification,threat_def,mitre_attackids,query,distinguishers,deleted,hidden,rf_rule,enabled,alert,revisions,risk,create_date,update_date,disabled_reason,tuned,tuningSearch,tuningEventsThreshold,tuningSecondsThreshold,customer_id,weblink,mitre_tactics,severity,confidence,count,extra_f1,extra_f2,threatvector,os,eventids,threattype,ruletype,Commnets,Categorization,Metadata_update,Rule Count before,Rule Count After,Tags,RA - investigate,RA - contain,RA - remediate
1.1.2663,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Brute Force Attempt by User],"This rule looks for multiple ""AzureActiveDirectory"" failed login attempts for the same username within a short period of time. This could indicate a brute force attack, but could also be related to benign misconfiguration. If this activity originated from outside the corporate network, a higher priority may be warranted. Consider tuning the thresholds on this rule to reduce alert volume for innocuous failures.","microsoft,o365,office 365,meth.access.bruteforce,Credential Access,Brute Force,T1110,md-info",Delivery,Methodology,Methodology,T1110,"class=ms_office365 service=azureactivedirectory action=userloginfailed (has:srcipv4 OR has:srcipv6) has:username errormessage=[invalidusernameorpassword,idslocked,useraccountnotfound,userdisabled,useraccountnotindirectory] NOT username:`not available` NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,3,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2663,Credential Access,Low,Low,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,"threshold, time",standalone native,Native,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.1,4.2.2,4.3.2
1.1.2664,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Brute Force Attempt by IP],"This rule looks for multiple ""AzureActiveDirectory"" failed login attempts from the same source IP within a short period of time. This could indicate a brute force or password spray attack, but could also be related to benign misconfiguration. If this activity originated from outside the corporate network, a higher priority may be warranted. Consider tuning the thresholds on this rule to reduce alert volume for innocuous failures.","microsoft,o365,office 365,meth.access.bruteforce,Credential Access,Brute Force,T1110,md-info",Delivery,Methodology,Methodology,T1110,"class=ms_office365 service=azureactivedirectory action=userloginfailed (has:srcipv4 OR has:srcipv6) has:username errormessage=[invalidusernameorpassword,idslocked,useraccountnotfound,userdisabled,useraccountnotindirectory] NOT username:`not available` NOT srcipv4:$exclusions.global.srcipv4","srcipv4,srcipv6",FALSE,FALSE,FALSE,TRUE,ON,4,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2664,Credential Access,Low,Low,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,"threshold, time",standalone native,Native,,,"Trellix Cloud, Trellix Atomic, Trellix Network Artifact","4.1.1, 3.1.2","4.2.2, 3.2.1",3.3.1
1.1.2665,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Tor Failed Login],"This rule looks for failed login activity from a Tor exit node. This could indicate an attacker probing accounts from an anonymized souce. Tor can also be used for legitimate purposes, so the severity of this alert largely depends on your organization's policy.","microsoft,o365,office 365,proto.tor.exit,Command and Control,Proxy,T1090,Multi-hop Proxy,T1090.003,md-info",Delivery,Methodology,Methodology,"T1090,T1090.003",class=ms_office365 action=userloginfailed context_tags:tor_exit NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,3,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2665,Command and Control,Low,High,0,NA,NA,Network,NA,NA,Methodology,3rd party,,standalone native,Cloud,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 3.1.2","4.2.2, 3.2.1",3.3.1
1.1.2666,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Mail Forward Attempt],"This rule looks for a user attempting to set up mail forwarding. Based on the corporate policy, this action may or may not have succeeded.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-info",Delivery,Methodology,Methodology,T1114,"class=ms_office365 service=exchange action=`set-mailbox` rawmsg:&[`DeliverToMailboxAndForward`,`ForwardingSmtpAddress`] NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2666,Collection,Medium,High,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,4.1.1,4.2.2,4.3.2
1.1.2788,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Inbox Rule Mail Forward],"This rule looks for a user attempting to forward email by using an Outlook filtering rule. This may be benign activity. Attackers who compromise Office 365 email accounts typically leverage email filtering rules to steal email. If this rule triggers an alert, inspect the recipient email address and source IP of the activity for suspicious behavior.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-info",Act,Methodology,Methodology,T1114,"class=ms_office365 service=exchange action=`new-inboxrule` rawmsg:[`ForwardTo`,`ForwardAsAttachmentTo`,`RedirectTo`] NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2788,Collection,Low,High,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,4.1.1,4.2.2,4.3.2
1.1.2789,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Inbox Rule Suspicious Delete],"This rule looks for a user creating an Outlook filtering rule to delete messages containing suspicious terms. These terms may indicate a user is compromised, used the account to phish others in the organization, and is covering their tracks by deleting any replies to the phish. If this rule triggers an alert, inspect the filtering terms used and source IP of the activity for signs of suspicious behavior.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-info",Act,Methodology,Methodology,T1114,"class=ms_office365 service=exchange action=`new-inboxrule` rawmsg:&[`SubjectOrBodyContainsWords`,`DeleteMessage`] rawmsg:[`Your document has been completed`,`your documents`,`please review`] NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2789,Collection,Medium,Medium,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,4.1.1,4.2.2,4.3.2
1.1.2790,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [eDiscovery Password Search],"This rule looks for an eDiscovery search containing ""password"". Attackers have been known to compromise O365 accounts that have eDiscovery rights, and use this tool to search for sensitive content like passwords.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-info",Act,Methodology,Methodology,T1114,"class=ms_office365 service=securitycompliancecenter action=[`searchcreated`,`searchupdated`] rawmsg:password NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2790,Collection,Medium,Low,0,NA,NA,Cloud,NA,NA,Vulnerability,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.1,4.2.2,4.3.2
1.1.2791,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Multiple eDiscovery Exports],This rule looks for multiple eDiscovery exports from the same user within a short period of time. This could indicate a compromised account exporting email.,"microsoft,o365,office 365,Collection,Email Collection,T1114,md-info",Act,Methodology,Methodology,T1114,"class=ms_office365 service=securitycompliancecenter action=[searchexported,searchexportdownloaded] NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2791,Collection,Medium,Low,0,NA,NA,Email,NA,NA,Exploit,3rd party,,standalone native,Methodology,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.1,4.2.2,4.3.2
1.1.2815,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Tor Authenticated Activity],"This rule looks for authenticated activity from a Tor exit node. This could indicate a compromised account with the attacker hiding their tracks with Tor. Tor can also be used for legitimate purposes, so the severity of this alert largely depends on your organization's policy.","microsoft,o365,office 365,proto.tor.exit,Command and Control,Proxy,T1090,md-action",Installation,Methodology,Methodology,T1090,class=ms_office365 !action=userloginfailed context_tags:tor_exit (missing:errormessage OR errormessage=none) NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,2,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2815,Command and Control,High,Medium,0,NA,NA,Network,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 3.1.2","4.2.2, 3.2.1",3.3.1
1.1.2823,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Mail Forward Webmail],"This rule looks for a user attempting to forward email to a public webmail provider such as Gmail or Hotmail. Attackers who compromise Office 365 email accounts typically leverage email filtering/forwarding rules to steal email. If this rule triggers an alert, inspect the recipient email address and source IP of the activity for signs of suspicious behavior.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-action",Act,Methodology,Methodology,T1114,"class=ms_office365 service=exchange ((action=`new-inboxrule` rawmsg:[`ForwardTo`,`ForwardAsAttachmentTo`,`RedirectTo`]) OR (action=`set-mailbox` rawmsg:&[`DeliverToMailboxAndForward`,`ForwardingSmtpAddress`])) rawmsg:[`@gmail.com`,`@yahoo.com`,`@hotmail.com`,`@protonmail.com`,`@pm.me`,`@outlook.com`] NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2823,Collection,High,Medium,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.1,4.2.2,4.3.2
1.1.2825,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [eDiscovery Suspicious Search Name],"This rule looks for an eDiscovery search name that is one character in length. Attackers have been known to compromise O365 accounts that have eDiscovery rights, and use this tool to search for sensitive content. One tactic that has been seen is using search names that are only one character in length. If this rule triggers an alert, inspect recent activity for that user for signs of compromise.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-action",Act,Methodology,Methodology,T1114,class=ms_office365 service=securitycompliancecenter action:`search*` (length(object)=1 OR object:/^.{1}$/) NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,1,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2825,Collection,High,Medium,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.1,4.2.2,4.3.2
1.1.2828,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Mailbox Audit Bypass],This rule looks for an Exchange mailbox that was configured to bypass mailbox audit logging. This can be used to reduce noise for accounts that generate numerous logs. This could also be used by an attacker to cover their tracks.,"microsoft,o365,office 365,Collection,Email Collection,T1114,md-info",Act,Methodology,Methodology,T1114,class=ms_office365 service=exchange action=set-mailboxauditbypassassociation NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2828,Collection,Medium,Medium,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,4.1.1,4.2.2,4.3.2
1.1.2829,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Get Global Address List],"This rule looks for an attempt to get the Exchange global address list (GAL). This could indicate an attacker performing reconnaissance against an Office 365 Exchange deployment. If this rule triggers an alert, inspect actions from the user around the time of this alert for other signs of compromise.","microsoft,o365,office 365,Collection,Email Collection,T1114,Discovery,Account Discovery,T1087,Email Account,T1087.003,md-info",Recon,Methodology,Methodology,"T1114,T1087,T1087.003",class=ms_office365 service=exchange action=get-globaladdresslist NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2829,"Collection,Discovery",Low,Medium,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,4.1.1,4.2.2,4.3.2
1.1.2895,Office 365,internal,e4d4f884-06aa-4d62-8595-4fe1fb6634c0,MICROSOFT AZURE [Sign-In From Tor],"This rule looks for a successful login from a Tor exit node. This could indicate a compromised account with the attacker hiding their tracks with Tor. Tor can also be used for legitimate purposes, so the severity of this alert largely depends on your organization's policy.","microsoft,azure,proto.tor.exit,Command and Control,Proxy,T1090,Multi-hop Proxy,T1090.003,md-action",Installation,Methodology,Methodology,"T1090,T1090.003",class=ms_azure eventtype=signinlogs result=0 context_tags:tor_exit NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,2,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2895,Command and Control,High,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 3.1.2","4.2.2, 3.2.1",3.3.1
1.1.2920,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Executive Mailbox and Folder Permission Change],"This rule looks for modifications of mailbox permissions or folder permissions inside a mailbox. This is limited to high-value executive user mailboxes. This may be benign activity. However, external attackers or a malicious insider might change permissions to allow access to view sensitive messages or for insider trading. If this rule triggers an alert, verify the source IP, the type of logon (Owner, Delegate or Admin), and hour of operation.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-info",Act,Methodology,Methodology,T1114,"class:ms_office365 service=`exchange` action=[sendas,sendonbehalf,updateinboxrules,addfolderpermissions,removefolderpermissions,modifyfolderpermissions,add-mailboxfolderpermission,remove-mailboxfolderpermission,add-mailboxpermission,remove-mailboxpermission] result=`succeeded` username:$executive_users NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2920,Collection,Medium,High,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.1,4.2.2,4.3.2
1.1.2966,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Malware Detected],"This rule looks for an Office 365 event indicating that malware was found in a file uploaded by a user. According to the Office 365 documentation, ""Files are scanned for viruses after they are uploaded. If a file is found to be infected, a property is set so that users can't download or sync the file.""","office365,o365,Execution,User Execution,T1204,Malicious File,T1204.002,md-info",Delivery,Methodology,Methodology,"T1204,T1204.002",class=ms_office365 action=filemalwaredetected NOT srcipv4:$exclusions.global.srcipv4,object,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2966,Execution,Medium,Medium,0,NA,NA,Cloud,NA,NA,Malware,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.2967,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [User Added to Admin Group],"This rule looks for an Office 365 event indicating that a user was added to an admin group. If this rule triggers an alert, investigate whether the user being elevated is authorized to be part of an admin group.","Persistence,Account Manipulation,T1098,md-info",Act,Methodology,Methodology,T1098,"class=ms_office365 action=[update-rolegroupmember,add-rolegroupmember] rawmsg:/admin/ NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2967,Persistence,Low,High,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.2997,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [External PowerShell Mailbox Access],"This rule looks for Exchange mailbox access using PowerShell/WinRM from a non-homenet source. This could indicate that an attacker accessed a mailbox programmatically. If the source is originating from a home network, consider adding it to the ""home.nets"" list.","office 365,o365,powershell,winrm,Collection,Email Collection,T1114,md-info",Act,Methodology,Methodology,T1114,class=ms_office365 service=exchange action=mailboxlogin clientvars=`client=microsoft.exchange.powershell; microsoft winrm client` NOT (srcipv4:$home_net OR srcdomain=$home_domain) NOT srcipv4:$exclusions.global.srcipv4,srcipv4,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.2997,Collection,Low,High,0,NA,NA,Email,NA,NA,Exploit,3rd party,,standalone native,Cloud,,,"Trellix Cloud, Trellix Atomic, Trellix Network Artifact",3.1.4,3.2.1,3.3.1
1.1.3021,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 METHODOLOGY [Strong Authentication Disabled],"This rule looks for when MFA was successfully disabled on an account. This may be legitimate activity, for example when trying to recover an account. Investigate this activity, especially for high-privilege accounts.","o365,office 365,authentication,Persistence,Account Manipulation,T1098,md-info",Act,Methodology,Methodology,T1098,class:ms_office365 service:azureactivedirectory action=`disable strong authentication.` result:success NOT srcipv4:$exclusions.global.srcipv4,"username,srcipv4",FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3021,Persistence,Low,High,0,NA,NA,Cloud,NA,NA,Exploit,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.2, 4.3.3"
1.1.3022,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Disable Audit Log],This alert identifies Office 365 logs where the admin audit log is disabled. This may be indicative of an attacker attempting to remove visibility into the system activity. Verify user and source IPv4 and confirm that this was done intentionally and authorized.,"office365,office 365,microsoft,audit,T1070,md-info",Act,Methodology,Methodology,T1070,"class:ms_office365 action:`Set-AdminAuditLogConfig` rawmsg:/""Name"":\s""AdminAuditLogEnabled"",\s""Value"":\s""False""/ NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3022,Defense Evasion,Medium,High,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.2, 4.3.1"
1.1.3026,Office 365,internal,adf68595-9371-4a91-8162-627c3bfa0cce,OFFICE 365 [Blocked Phish],This rule looks for quarantined or blocked email that Office 365 Threat Intelligence flagged as phishing.,"office365,office 365,microsoft,threat intel,Initial Access,Phishing,T1566,md-info",Delivery,Methodology,Methodology,T1566,"class=ms_office365 service=threatintelligence category=phish result:[`quarantine`,`block`] NOT srcipv4:$exclusions.global.srcipv4",from,FALSE,FALSE,FALSE,TRUE,OFF,6,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3026,Initial Access,Low,Medium,0,NA,NA,Email,NA,NA,Methodology,Intel,,standalone proxy rules,Cloud,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.2, 4.3.1"
1.1.3027,Office 365,internal,adf68595-9371-4a91-8162-627c3bfa0cce,OFFICE 365 [Email Malware],"This rule looks for Office 365 Threat Intelligence malware alerts, specifically for email that has not been deleted, blocked, quarantined, or that had attachments replaced per the filtering policy.","office365,office 365,microsoft,threat intel,Initial Access,Phishing,T1566,Spearphishing Attachment,T1566.001,md-info",Delivery,Methodology,Methodology,"T1566,T1566.001","class=ms_office365 service=threatintelligence category=malware has:result result!:[`delete`,`quarantine`,`replaceattachment`,`block`,`replaced`,`junked`] NOT srcipv4:$exclusions.global.srcipv4",from,FALSE,FALSE,FALSE,TRUE,ON,5,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3027,Initial Access,Medium,Medium,0,NA,NA,Email,NA,NA,Malware,Intel,,standalone proxy rules,Cloud,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.2, 4.3.1"
1.1.3028,Office 365,internal,adf68595-9371-4a91-8162-627c3bfa0cce,OFFICE 365 [TI URL Click],"This rule looks for Office 365 Threat Intelligence URL click event alerts. These alerts are only available when ATP Safe Links are enabled. For details, see the information link below.","office365,office 365,microsoft,threat intel,Initial Access,Phishing,T1566,md-info",Delivery,Methodology,Methodology,T1566,class=ms_office365 service=threatintelligence action=tiurlclickdata NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,3,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3028,Initial Access,High,Medium,0,NA,NA,Cloud,NA,NA,Methodology,Intel,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.2, 4.3.1"
1.1.3256,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [New Inbox Rule - MoveToFolder RSS Subscriptions/Feeds],"This rule looks for when a new Inbox rule is created in Outlook that involves moving mail to the RSS Subscriptions or the RSS Feeds folder. While it is possible (and unlikely) that there could be legitimate uses for this, it is also a technique sometimes used by threat actors and can indicate that the account in question is compromised.","o365,office 365,authentication,Collection,Email Collection,T1114,md-action",Act,Methodology,Methodology,T1114,"class=ms_office365 action:[`new-inboxrule`,`set-inboxrule`] rawmsg:`MoveToFolder` rawmsg:[`RSS Feeds`,`RSS Subscriptions`] NOT srcipv4:$exclusions.global.srcipv4","username,srcipv4",FALSE,FALSE,FALSE,TRUE,ON,3,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3256,Collection,High,Medium,0,NA,NA,Email,NA,NA,Malware,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3319,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Oauth2 Permission Grant],"This rule looks for an Azure-registered application that uses Oauth2 authentication to get access to data. Illicit consent grant attacks occur when an attacker tricks end users into granting an application consent to access their data through a phishing attack or by injecting illicit code into a trusted website. After the illicit application has been granted consent, it has account-level access to data without the need for an organizational account. Normal remediation steps, like resetting passwords for breached accounts or requiring Multi-Factor Authentication (MFA) on accounts, are not effective against this type of attack, since these are third-party applications and are external to the organization. In logs, illegitimate grants look the same as legitimate ones, so these informational events should be investigated to determine if the application being granted permission is approved.","office365,microsoft,o365,oauth2,Credential Access,Steal Application Access Token,T1528,md-info",NA,Methodology,Methodology,T1528,class=ms_office365 action:`add oauth2permissiongrant*` NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3319,Credential Access,Low,Medium,0,NA,NA,Cloud,NA,NA,Vulnerability,3rd party,,standalone native,Methodology,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3320,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Suspicious File Type Uploaded],"Identifies when executable file types are uploaded to Office services such as SharePoint and OneDrive. List currently includes 'exe', 'cmd', 'bat' file extensions. If a user is uploading these files to another users' workspace, it could be an indication of a staging location for malware or other malicious activity.","office 365,o365,uploads,Command and Control,Lateral Movement,Remote File Copy,T1105,md-info",NA,Methodology,Methodology,T1105,"class=ms_office365 action:fileuploaded filetype:[`exe`,`cmd`,`bat`] NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3320,Command and Control,Low,Medium,0,NA,NA,Cloud,NA,NA,Malware,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3321,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Policy Tampered],"This alert identifies any tampering of either ATP Safelink, SafeAttachment, AntiPhish or Dlp policy. This may be an attempt to evade the detection or any other policy based defenses.","office365,office 365,microsoft,policy,Persistence,Account Manipulation,T1098,md-action",Act,Methodology,Methodology,T1098,"class=ms_office365 action:[`remove-antiphish*`,`disable-antiphish*`,`disable-safelinks*`,`remove-safelinks*`,`disable-safeattachment*`,`remove-safeattachment*`,`remove-dlp*`,`disable-dlp*`] NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3321,Persistence,Medium,High,0,NA,NA,Endpoint,NA,NA,Methodology,3rd party,,standalone native,Cloud,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3334,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Multiple Owner Changed From Same User],"Commonly within an organization, users will set up Teams as needed for specific projects or topics, and will own the Teams they create. Most organizations will have different owners for each Team, and rarely will one user be an owner of more than a small number of Teams. An attacker seeking to elevate privileges may look to make themselves owner of a large number of Teams. This rule detects multiple owner changed by a single user within a short period of time.","microsoft,o365,Teams,ms_office365,Defense Evasion,Initial Access,Persistence,Privilege Escalation,Valid Accounts,T1078,md-info",NA,Suspicious,Methodology,T1078,"class=ms_office365 service=microsoftteams action=memberrolechanged rawmsg:`""Role"": 2` NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,2,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3334,"Defense Evasion,Initial Access,Persistence,Privilege Escalation",Low,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3335,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Multiple Teams Deleted],"As with ownership of a Team, the process of deleting a Team is often one carried out by individual Owners rather than a single central user. Given Teams are often used for critical services such as incident management it is possible that an attacker looking to cause disruption could seek to delete multiple Teams. This rule detects a single user deleting multiple Teams to monitor such activity and identify the malicious user.","o365,microsoft,Teams,office 365,Impact,Data Destruction,T1485,Service Stop,T1489,md-info",Act,Methodology,Methodology,"T1485,T1489",class=ms_office365 service=microsoftteams action=teamdeleted NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3335,Impact,Low,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3376,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Consent To Application],"This rule looks for a user who obtains access to data via OAuth2 authentication after granting consent to an Azure-registered application. Illicit consent grant attacks occur when an attacker tricks an end user into granting that application consent to access their data either through a phishing attack, or by injecting illicit code into a trusted website. After the illicit application has been granted consent, it has account-level access to data without the need for an organizational account. Normal remediation steps, like resetting passwords for breached accounts or requiring Multi-Factor Authentication (MFA) on accounts, are not effective against this type of attack, because these are third-party applications and are external to the organization. In logs, illegitimate grants look the same as legitimate ones, so these informational events should be investigated to determine if the application being granted permission is approved.","office365,microsoft,o365,oauth2,Credential Access,Steal Application Access Token,T1528,md-info",NA,Methodology,Methodology,T1528,class=ms_office365 action:`consent to application*` NOT rawmsg:`offline_access` NOT srcipv4:$exclusions.global.srcipv4,"username,target",FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3376,Credential Access,Low,High,0,NA,NA,Cloud,NA,NA,Vulnerability,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.2,4.2.2,"4.3.1, 4.3.2"
1.1.3377,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Consent To Application With Offline Access],"This rule rule looks for a user who obtains access to data via OAuth2 authentication after granting consent to an Azure-registered application. This rule checks if offline_access permissions, which allow an application to renew its token without user interaction, are granted. Illicit consent grant attacks occur when an attacker tricks an end user into granting that application consent to access their data either through a phishing attack, or by injecting illicit code into a trusted website. After the illicit application has been granted consent, it has account-level access to data without the need for an organizational account. Normal remediation steps, like resetting passwords for breached accounts or requiring Multi-Factor Authentication (MFA) on accounts, are not effective against this type of attack, because these are third-party applications and are external to the organization. In logs, illegitimate grants look the same as legitimate ones, so these informational events should be investigated to determine if the application being granted permission is approved.","office365,microsoft,o365,oauth2,Credential Access,Steal Application Access Token,T1528,md-info",NA,Methodology,Methodology,T1528,class=ms_office365 action:`consent to application*` rawmsg:`offline_access` NOT srcipv4:$exclusions.global.srcipv4,"username,target",FALSE,FALSE,FALSE,TRUE,ON,2,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3377,Credential Access,Medium,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior",4.1.2,4.2.2,"4.3.1, 4.3.2"
1.1.3432,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Inbox Rule Delete],"This rule looks for any new inbox rule designed to automatically delete messages or move messages into the Deleted Items Folder. This may indicate a user has been compromised, used the account to phish others in the organization, and is covering their tracks. Inspect the filtering terms used and source IP of the activity for signs of suspicious behavior.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-action",Act,Methodology,Methodology,T1114,"class=ms_office365 service=exchange action=`new-inboxrule` (rawmsg:&[`DeleteMessage`,`SubjectOrBodyContainsWords`] OR rawmsg:&[`DeleteMessage`,`SubjectContainsWords`] OR rawmsg:&[`MoveToFolder`,`Deleted Items`,`SubjectContainsWords`]) NOT srcipv4:$exclusions.global.srcipv4","username,srcipv4",FALSE,FALSE,FALSE,TRUE,ON,3,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3432,Collection,High,Medium,0,NA,NA,Email,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3442,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,AADINTERNALS UTILITY [User-Agent],"AADInternals is a PowerShell module that can be used for administering and hacking Office 365 and Azure AD. While this can be used for legitimate purposes, its hacking capabilities can be used by attackers to compromise cloud environments. This rule detects the presence of a useragent associated with this tool in the Office 365 or Azure logs. This could be an indicator that nefarious activity is afoot.","aadinternals,cloud,azure,o365,Collection,Credential Access,Input Capture,T1056,Credential API Hooking,T1056.004,md-info",Delivery,Methodology,Methodology,"T1056,T1056.004","class=[ms_office365,ms_azure] useragent:`aadconnect/*` NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3442,"Collection,Credential Access",Medium,Medium,0,NA,NA,Cloud,NA,NA,Exploit,3rd party,,standalone native,Methodology,,,"Trellix Cloud, Trellix Atomic,  Trellix Tools","4.1.1,4.1.2",4.2.1,"4.3.1,4.3.2"
1.1.3444,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Federated Domain Set],"This rule looks for when a new federated domain is configured. Attackers can create rogue federated domains to compromise cloud accounts. If this rule triggers an alert, inspect the domain in the ""target"" field and where the user originated the request.","aadinternals,cloud,azure,o365,Collection,Credential Access,Input Capture,T1056,Credential API Hooking,T1056.004,md-action",Delivery,Methodology,Methodology,"T1056,T1056.004",class=ms_office365 action:`set domain authentication*` NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,1,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3444,"Collection,Credential Access",High,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3490,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [User Added to Security And Compliance Center],"This rule looks for an Office 365 event indicating that a user was added to a Security & Compliance Center role group. A role group is a set of roles, and a role grants permissions to do a set of security and compliance tasks like device management, data loss prevention, eDiscovery, retention, compliance search and so on. If this rule triggers an alert, investigate whether the user being elevated is authorized to be part of that role group.","office 365,o365,security and compliance center,compliance,Persistence,Account Manipulation,T1098,md-info",Act,Methodology,Methodology,T1098,class=ms_office365 service=securitycompliancecenter action=add-rolegroupmember NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3490,Persistence,Low,High,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3527,Office 365,internal,adf68595-9371-4a91-8162-627c3bfa0cce,OFFICE 365 [Allowed Phish],This rule looks for unblocked email that Office 365 Threat Intelligence flagged as phishing.,"office365,office 365,microsoft,threat intel,Initial Access,Phishing,T1566,md-info",Delivery,Methodology,Methodology,T1566,"class=ms_office365 service=threatintelligence category=phish has:result result!:[`movetojmf`,`delete`,`quarantine`,`block`,`deliveredasspam`] NOT srcipv4:$exclusions.global.srcipv4",from,FALSE,FALSE,FALSE,TRUE,ON,5,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3527,Initial Access,Medium,Medium,0,NA,NA,Email,NA,NA,Methodology,Intel,,standalone proxy rules,Cloud,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.2, 4.3.1"
1.1.3528,Office 365,internal,adf68595-9371-4a91-8162-627c3bfa0cce,OFFICE 365 [Junk Mail Phish],This rule looks for an email that Office 365 Threat Intelligence flagged as phishing and then routed to the Junk Mail folder.,"office365,office 365,microsoft,threat intel,Initial Access,Phishing,T1566,md-info",Delivery,Methodology,Methodology,T1566,"class=ms_office365 service=threatintelligence category=phish result:[`deliveredasspam`,`movetojmf`] NOT srcipv4:$exclusions.global.srcipv4",from,FALSE,FALSE,FALSE,TRUE,OFF,4,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3528,Initial Access,Low,Medium,0,NA,NA,Email,NA,NA,Methodology,Intel,,standalone proxy rules,Cloud,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.2, 4.3.1"
1.1.3537,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [User Added Credentials to Service Principal],"This rule looks for a user adding credentials to an Azure service principal. For example, connected apps are resources that use service principals. By default, these resources cannot be used to log in. However, attackers that already have a compromised admin account may add credentials to service principals, and then use these credentials to access everything the service principal can access, such as reading all emails for users who connected that app.","microsoft,o365,office 365,Persistence,Account Manipulation,T1098,Additional Cloud Credentials,T1098.001,md-action",NA,Methodology,Methodology,"T1098,T1098.001",class=ms_office365 action:`add service principal credentials*` NOT actor:`managed service identity*` NOT srcipv4:$exclusions.global.srcipv4,username,FALSE,FALSE,FALSE,TRUE,ON,3,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3537,Persistence,High,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3565,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Modified Domain Federation Settings],"This rule looks for modifications to domain federation settings by a user or an application. For example, this rule triggers an alert when a new Active Directory Federated Service (ADFS) TrustedRealm object, such as a signing certificate, is added to the domain. Modification to domain federation settings should be rare. If this rule triggers an alert, confirm whether the added or modified target domain/URL is legitimate administrator behavior.","microsoft,o365,office 365,Defense Evasion,Privilege Escalation,Access Token Manipulation,T1134,md-action",NA,Methodology,Methodology,T1134,class=ms_office365 action:`set federation settings on domain` NOT srcipv4:$exclusions.global.srcipv4,"username,srcipv4,srcipv6",FALSE,FALSE,FALSE,TRUE,ON,1,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3565,"Defense Evasion,Privilege Escalation",High,Medium,0,NA,NA,Network,NA,NA,Methodology,3rd party,,standalone proxy rules,Cloud,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3567,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Azure AD PowerShell Accessing Non-AAD Resources],"This rule looks for a user or an application using Azure Active Directory PowerShell to sign in to access non-Active Directory resources, such as Microsoft Graph. This may be undesired or unauthorized behavior.","microsoft,o365,office 365,Azure AD,Azure AD powershell,Defense Evasion,Initial Access,Persistence,Privilege Escalation,Valid Accounts,T1078,Cloud Accounts,T1078.004,md-info",NA,Methodology,Methodology,"T1078,T1078.004",class=ms_office365 appid=1b730954-1685-4b74-9bfd-dac224a7b894 has:object NOT object=00000002-0000-0000-c000-000000000000 action=userloggedin NOT srcipv4:$exclusions.global.srcipv4,"username,srcipv4,srcipv6",FALSE,FALSE,FALSE,TRUE,ON,1,Low,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3567,"Defense Evasion,Initial Access,Persistence,Privilege Escalation",Low,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3600,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Mailbox Permission Change - Everyone Allowed],"This rule looks for the ""Everyone"" user getting excessive permissions to a user's mailbox. This technique has been used by attackers to gain access to a mailbox without needing to log in interactively as that user. Granular access can be granted to individual folders in a Microsoft Exchange mailbox by modifying folder permissions. The mailbox owner can directly grant these permissions. Permissions can also be granted on behalf of the mailbox owner by an account that was delegated access to the mailbox or by an Exchange administrator. For each mailbox, the user-accessible folders (such as Inbox, Sent Items, and Deleted Items) reside within a hidden folder root called the ""Top of Information Store."" Like user-visible folders, folder permissions can be granted to this folder.","microsoft,o365,office 365,Collection,Email Collection,T1114,md-action",Act,Methodology,Methodology,T1114,"class=ms_office365 action:[`modifyfolderpermissions`,`addfolderpermissions`] target:[`inbox`,`top of information store`] targetusername=`everyone` NOT accesses:`none` NOT accesses=[`freebusysimple`,`visible, freebusysimple`] NOT srcipv4:$exclusions.global.srcipv4","username,targetusername",FALSE,FALSE,FALSE,TRUE,ON,2,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3600,Collection,High,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3831,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [TI ATP - <%= virus %>],"Office 365 Advanced Threat Protection alerts for phishing and malware file events in Sharepoint Online, OneDrive for Business, and Microsoft Teams.","office365,office 365,microsoft,Execution,User Execution,T1204,Malicious File,T1204.002,md-info",Delivery,Methodology,Methodology,"T1204,T1204.002",class=ms_office365 action=atpdetection type=47 NOT srcipv4:$exclusions.global.srcipv4,"username,rule,virus",FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3831,Execution,Medium,Medium,0,NA,NA,Cloud,NA,NA,Malware,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3980,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Device Access Policy Changed],"This rule looks for modifications made to device access policy. If this rule triggers an alert, check the event to see if the behavior is expected or performed by an authorized entity.","microsoft,o365,office 365,md-info",NA,Methodology,Methodology,NA,class=ms_office365 action:`deviceaccesspolicychanged` NOT srcipv4:$exclusions.global.srcipv4,"username,srcipv4,srcipv6",FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3980,NA,Medium,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.3981,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Anonymous Link Created],This rule looks for any anonymous link creation for files in OneDrive. This link allows access to an unauthenticated user. Inspect the event to see if the behavior is expected or performed by an authorized entity.,"microsoft,o365,office 365,anonymous,md-info",NA,Methodology,Methodology,NA,class=ms_office365 action:`anonymouslinkcreated` NOT srcipv4:$exclusions.global.srcipv4,"username,srcipv4,srcipv6",FALSE,FALSE,FALSE,TRUE,OFF,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.3981,NA,Medium,Medium,0,NA,NA,Cloud,NA,NA,Methodology,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.4091,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [File Malware - <%= virus %>],"This rule looks for Microsoft file scanning engine flags files uploaded to SharePoint as potentially harmful. Attackers can expand their access and move laterally within the organization via file sharing. Users may unwittingly share these malicious files, allowing adversaries to acquire initial access to other endpoints in the environment. If the rule triggers an alert, check the legitimacy of the activity and take neccessary remediation steps.","microsoft,o365,office 365,Cloud,Lateral Movement,Taint Shared Content,T1080,Lateral Tool Transfer,T1570,md-action",Installation,Suspicious,Methodology,"T1080,T1570",class:ms_office365 action:filemalwaredetected NOT srcipv4:$exclusions.global.srcipv4,"username,virus",FALSE,FALSE,FALSE,TRUE,ON,1,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.4091,Lateral Movement,High,Medium,0,NA,NA,Cloud,NA,NA,Malware,3rd party,,standalone proxy rules,,,,passthrough: Microsoft O365,"4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.4177,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,OFFICE 365 [Full Access as App Role Granted],This rule looks for `full_access_as_app` permission being granted to the an OAuth application with the consent of admin. This permission is exploited by Threat actors to access sensitive data as this provides full access to the Exchange mailboxes via EWS API. The Application granted this permission should be reviewed for it's aunthenticity.,"microsoft,o365,office 365,midnight blizzard,Credential Access,Steal Application Access Token,T1528,Persistence,Account Manipulation,T1098,md-info",Act,Methodology,Methodology,"T1528,T1098","class:ms_office365 action=`add app role assignment to service principal.` rawmsg:&[`AppRole.Value`,`full_access_as_app`] result:`success` NOT srcipv4:$exclusions.global.srcipv4",username,FALSE,FALSE,FALSE,TRUE,ON,1,Medium,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.4177,"Credential Access,Persistence",Medium,Medium,0,NA,NA,Cloud,NA,NA,Methodology,Native,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"
1.1.4198,Office 365,internal,d99bbccf-251f-4874-9a98-65517b76d7c0,MICROSOFT AZURE [OAuth Application Privileged Access],This rule looks for assignments of high privileged permissions granted to an OAuth application. It examines Microsoft Graph permissions that grant the ability to manage permissions associated with both application and directory data. Threat actors often exploit these permissions to gain unauthorized access to sensitive information.It is recommended to review the legitimacy of the user account and application associated with this alert.,"microsoft,o365,office 365,midnight blizzard,Persistence,Account Manipulation,T1098,Additional Email Delegate Permissions,T1098.002,Additional Cloud Roles,T1098.003,md-action",Act,Methodology,Methodology,"T1098,T1098.002,T1098.003","class=ms_azure eventtype=auditlogs action=`update application` has(description) description:/ > .*?entitlementid\"":\""(1bfefb4e-e0b5-418b-a88f-73c46d2cc8e9)|(06b708a9-e830-4db3-a914-8e69da51d44f)|(19dbc75e-c2e2-444c-a770-ec69d8559fc7)|(9e3f62cf-ca93-4989-b6ce-bf83c28f9fe8)|(dc890d15-9560-4a4c-9b7f-a736ec74ec40)/ NOT srcipv4:$exclusions.global.srcipv4",callingusername,FALSE,FALSE,FALSE,TRUE,ON,1,High,##########,##########,NA,FALSE,NA,NA,NA,NA,https://apps.fireeye.com/helix/id/hexzbh476/rules/1.1.4198,Persistence,High,Medium,0,NA,NA,Cloud,NA,NA,Methodology,Native,,standalone native,,,,"Trellix Cloud, Trellix Atomic, Trellix User Behavior","4.1.1, 4.1.2",4.2.2,"4.3.1, 4.3.2"